<a class="govuk-back-link" href="javascript:history.back()">Back</a>
<xuilib-hmcts-error-summary [errorMessages]="validationErrors" [header]="'There is a problem'">
</xuilib-hmcts-error-summary>
<div class="govuk-notification-banner govuk-notification-banner--success" role="alert"
  aria-labelledby="govuk-notification-banner-title" data-module="govuk-notification-banner"
  *ngIf="validationErrors.length == 0 && successBanner">
  <div class="govuk-notification-banner__header">
    <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
      Success
    </h2>
  </div>
  <div class="govuk-notification-banner__content">
    <p class="govuk-body">Details submitted</p>
  </div>
</div>

<xuilib-hmcts-error-summary [errorMessages]="serverErrors" [header]="'There is a problem'" *ngIf="error$ | async">
</xuilib-hmcts-error-summary>

<div class="govuk-grid-row" *ngIf="hearingActualsMainModel">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-m">Hearing details</h1>
    <dl class="govuk-summary-list">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">Hearing date(s)</dt>
        <dd class="govuk-summary-list__value">{{hearingDate}}</dd>
      </div>
    </dl>
    <br>

    <h1 class="govuk-heading-m">Hearing stage and result</h1>
    <span class="govuk-body align-right">
      <a href="javascript:void(0)" [routerLink]="['/', 'hearings', 'actuals', id, 'hearing-stage-result']"
        id="hearing-stage-result-update-link" class="govuk-link">Update</a>
    </span>
    <div class="govuk-error-message" *ngIf="hearingStageResultErrorMessage !== ''">
      {{hearingStageResultErrorMessage}}
    </div>
    <div [ngClass]="{'govuk-form-group govuk-form-group--error': hearingStageResultErrorMessage !== ''}">
      <dl class="govuk-summary-list">
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">Hearing stage</dt>
          <dd class="govuk-summary-list__value">{{hearingTypeDescription}}</dd>
        </div>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">Hearing result</dt>
          <dd class="govuk-summary-list__value">{{hearingResult}}</dd>
        </div>
      </dl>
    </div>
    <br>
    <h1 class="govuk-heading-m">Hearing date(s)</h1>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <div *ngIf="actualHearingDays">
      <details *ngFor="let actualHearingDay of actualHearingDays; let i = index"
               class="govuk-details" data-module="govuk-details"
               [open]="hearingDatesAccordion[actualHearingDay.hearingDate]">
        <summary class="govuk-details__summary"
                 (click)="$event.preventDefault(); hearingDatesAccordion[actualHearingDay.hearingDate] = !hearingDatesAccordion[actualHearingDay.hearingDate]"
        >
          <div class="govuk-details__summary-text govuk-!-padding-bottom-1">
            {{actualHearingDay.hearingDate | date: "dd MMMM yyyy"}}
          </div>
          <div
            class="govuk-tag"
            [class.govuk-tag--grey]="!getStatusLabel(actualHearingDay)">
            {{getStatusLabel(actualHearingDay) ? 'DETAILS PROVIDED' : 'AWAITING CONFIRMATION'}}
          </div>
        </summary>

        <div class="govuk-details__text listing-info">
          <dl class="govuk-summary-list govuk-!-margin-bottom-0 govuk-!-padding-right-2">
            <div class="govuk-summary-list__row govuk-!-margin-bottom-4">
              <dt class="govuk-summary-list__key ">Was this hearing day required?</dt>
              <dd class="govuk-summary-list__value">
                <div #requiredDayText>
                  {{actualHearingDay.notRequired ? 'No' : 'Yes'}}
                </div>
                <div #requiredDayInput hidden>
                  <fieldset class="govuk-fieldset" id="hearing-day-required-confirmation">
                    <div class="govuk-radios">
                      <div class="govuk-radios__item"
                           *ngFor="let button of [['Yes', false], ['No', true]]"
                           (click)="updateWasThisHearingDayRequired(actualHearingDay, button[1]);
                                  requiredDayText.hidden = false;
                                  requiredDayInput.hidden = true;
                               "
                      >
                        <input type="radio" class="govuk-radios__input"

                               [name]="'hearing-day-required__' + i"
                               [id]="'hearing-day-required-yes__' + i">
                        <label class="govuk-label govuk-radios__label" [for]="'hearing-day-required-yes__' + i">
                          {{ button[0] }}
                        </label>
                      </div>
                    </div>
                  </fieldset>
                </div>

              </dd>
              <dd class="govuk-summary-list__actions">
                <a href="javascript:void(0)" id="hearing-stage-result-change-link"
                   (click)="requiredDayText.hidden = !requiredDayText.hidden;
                   requiredDayInput.hidden = !requiredDayInput.hidden"
                   class="govuk-link">Change</a>
              </dd>
            </div>
            <ng-container *ngIf="!actualHearingDay.notRequired">
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">Hearing timings</dt>
                <dd class="govuk-summary-list__value"></dd>
                <dd class="govuk-summary-list__actions">
                  <a href="javascript:void(0)" (click)="confirmActualHearingTimeForDay(actualHearingDay)"
                     id="hearing-timing-result-confirm-link" class="govuk-link">
                    Confirm
                  </a>&nbsp;
                  <a [routerLink]="['/', 'hearings', 'actuals' , id, 'hearing-timing', actualHearingDay.hearingDate]" class="govuk-link">Update</a>
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">Start time</dt>
                <dd class="govuk-summary-list__value">{{actualHearingDay.hearingStartTime | date: "HH:mm"}}</dd>
                <dd class="govuk-summary-list__actions"></dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">Finish time</dt>
                <dd class="govuk-summary-list__value">{{actualHearingDay.hearingEndTime | date: "HH:mm"}}</dd>
                <dd class="govuk-summary-list__actions"></dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">Pause time</dt>
                <dd class="govuk-summary-list__value">{{getPauseStartDateTime(actualHearingDay)}}</dd>
                <dd class="govuk-summary-list__actions"></dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">Resume time</dt>
                <dd class="govuk-summary-list__value">{{getPauseEndDateTime(actualHearingDay)}}</dd>
                <dd class="govuk-summary-list__actions"></dd>
              </div>
              <div class="govuk-summary-list__row_no-border">
                <dt class="govuk-summary-list__key-no-border">&nbsp;</dt>
                <dd class="govuk-summary-list__value-no-border"></dd>
                <dd class="govuk-summary-list__actions"></dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">Participants</dt>
                <dd class="govuk-summary-list__value"></dd>
                <dd class="govuk-summary-list__actions">
                  <a href="javascript:void(0)" (click)="confirmActualPartiesForDay(actualHearingDay)"
                     id="hearing-parties-result-confirm-link" class="govuk-link">Confirm</a>&nbsp;
                  <a href="javascript:void(0)" [routerLink]="['/', 'hearings', 'actuals', id, 'actuals-parties', actualHearingDay.hearingDate]"
                     class="govuk-link">Update</a>
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">Names</dt>
                <dd class="govuk-summary-list__value">{{getPartiesNames(actualHearingDay)}}</dd>
                <dd class="govuk-summary-list__actions"></dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">How participants will attend</dt>
                <dd class="govuk-summary-list__value">
                  <div *ngFor="let party of getPartiesAttendenceMethod(actualHearingDay)">
                    {{party.fullName}}: {{party.partyChannelSubType | partyChannelDisplayValue: partyChannels}}
                  </div>
                </dd>
                <dd class="govuk-summary-list__actions"></dd>
              </div>
              <div class="govuk-summary-list__row" *ngFor="let party of actualHearingDay.actualDayParties; let i = index;">
                <dt class="govuk-summary-list__key">Attendee {{i + 1}}</dt>
                <dd class="govuk-summary-list__value">
                  Role: {{party.partyRole | partyRoleDisplayValue: hearingRoles}}<br>
                  First name: {{party.individualDetails.firstName}}<br>
                  Last name: {{party.individualDetails.lastName}}<br>
                  Organisation: {{party.actualOrganisationName}}<br>
                  Attendee Type: {{party.partyChannelSubType | partyChannelDisplayValue: partyChannels}} <br>
                  Attendee representing: {{party.representedParty && getRepresentingAttendee(party.representedParty, hearingDate)}}
                </dd>
              </div>
            </ng-container>
          </dl>
        </div>
      </details>
    </div>
  </div>
</div>

<div class="govuk-grid-row" *ngIf="hearingActualsMainModel">
  <div class="govuk-grid-column-two-thirds">
    <div class="govuk-error-message" *ngIf="hearingTimingResultErrorMessage !== ''">
      {{hearingTimingResultErrorMessage}}
    </div>

    <br>
    <h2 class="govuk-heading-m">Submit your hearing details</h2>
    <p class="govuk-body">Once you have entered the hearing details, select Submit hearing details.</p>
    <p class="govuk-body">Once submitted, you cannot change your answers again. The case will be saved and the hearing
      will be marked as complete.</p>
    <br>
    <div class="govuk-button-group">
      <button class="govuk-button primary" data-module="govuk-button" (click)="onSubmitHearingDetails()">
        Submit hearing details
      </button>
    </div>
  </div>
</div>
